import{a as C,R as g,_ as O,s as S,o as I,k as Y,l as R,z as M}from"./iframe-Dapn4dtX.js";import{l as b}from"./lodash-D9tnaJ50.js";import{B as N}from"./BaseButton-Be5aA3CC.js";var _={FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"}},c={DATE:"YYYYMMDD",TIME:"ThhmmssZ",FULL:"YYYYMMDDThhmmssZ",NO_UTC_FULL:"YYYYMMDDThhmmss",OUTLOOK_DATE:"YYYY-MM-DD",OUTLOOK_TIME:"Thh:mm:ssZ",OUTLOOK_FULL:"YYYY-MM-DDThh:mm:ssZ"},p={YAHOO:"https://calendar.yahoo.com/",GOOGLE:"https://calendar.google.com/calendar/render",OUTLOOK:"https://outlook.{{host}}.com/calendar/0/deeplink/compose"},d=function(a){return a===void 0&&(a=""),"0".concat(parseInt(a.toString(),10)).slice(-2)},w=function(a,r){var n=Math.floor((r-a)/1e3),t=Math.floor(n/3600),e=n/3600%1*60;return"".concat(d(t)).concat(d(e))},B=function(a,r){var n=Math.floor((r-a)/1e3);return Math.floor(n/3600)},k=function(a){var r=a.frequency,n=a.interval,t=_.FREQUENCY;if(n)switch(r){case t.YEARLY:return n*365.25;case t.MONTHLY:return n*30.42;case t.WEEKLY:return n*7;default:return n}return 365.25*100},A=function(a,r){a===void 0&&(a=new Date);var n={YYYY:a.getUTCFullYear(),MM:d(a.getUTCMonth()+1),DD:d(a.getUTCDate()),hh:d(a.getUTCHours()),mm:d(a.getUTCMinutes()),ss:d(a.getUTCSeconds())};return Object.keys(n).reduce(function(t,e){return t.replace(e,n[e].toString())},r)},q=function(a,r){a===void 0&&(a=new Date);var n={YYYY:a.getFullYear(),MM:d(a.getMonth()+1),DD:d(a.getDate()),hh:d(a.getHours()),mm:d(a.getMinutes()),ss:d(a.getSeconds())};return Object.keys(n).reduce(function(t,e){return t.replace(e,n[e].toString())},r)},j=function(){return A(new Date,c.FULL)},x=function(a,r){var n=r*864e5,t=new Date;return t.setTime(a.getTime()+n),t},o={addLeadingZero:d,getDuration:w,getHoursDiff:B,getRecurrenceLengthDays:k,formatDate:A,formatDateNoUtc:q,getTimeCreated:j,incrementDate:x},D=function(){function a(r){var n=this;this.isAllDay=!1,this.description="",this.title="",this.location="",this.start=new Date,this.end=new Date,this.params={},this.attendees=[],this.setText=function(t){n.description=t.description||"",n.title=t.title||"",n.location=t.location||""},this.setTimestamps=function(t){n.isAllDay=!t.end,n.start=t.start,n.end=t.end||o.incrementDate(n.start,1),n.recurrence=t.recurrence},this.setParam=function(t,e){return n.params[t]=e,n},this.setText(r),this.setTimestamps(r),this.setAttendees(r)}return a.prototype.setAttendees=function(r){this.attendees=Array.isArray(r.attendees)?r.attendees:[]},a}(),v=function(a,r){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},v(a,r)};function y(a,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");v(a,r);function n(){this.constructor=a}a.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}var h=function(){return h=Object.assign||function(r){for(var n,t=1,e=arguments.length;t<e;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},h.apply(this,arguments)};function u(a,r,n){if(n||arguments.length===2)for(var t=0,e=r.length,i;t<e;t++)(i||!(t in r))&&(i||(i=Array.prototype.slice.call(r,0,t)),i[t]=r[t]);return a.concat(i||Array.prototype.slice.call(r))}var T=function(a,r,n){r===void 0&&(r=";"),n===void 0&&(n=function(i){return i});var t=[];for(var e in a)a.hasOwnProperty(e)&&a[e]!==void 0&&t.push("".concat(e,"=").concat(n(a[e])));return t.join(r)},F=function(a){var r=Object.keys(a).filter(function(n){return a[n]!==null}).reduce(function(n,t){var e;return h(h({},n),(e={},e[t]=a[t],e))},{});return T(r,"&",encodeURIComponent)},V=function(a){return T(a,";")},H=function(a){return a.map(function(r){var n=r.email,t=r.name;return t?"".concat(t," <").concat(n,">"):n})},K=function(a){return[a[0].toUpperCase(),a.slice(-a.length+1).toLowerCase()].join("")},f={toParamString:T,toQueryString:F,toIcsParamString:V,toMailtoList:H,toProperCase:K},G=function(a){return a===void 0&&(a=""),a.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/[,;]/g,"\\$&")},Q=function(){return Math.random().toString(36).substr(2)},Z=function(){return typeof window<"u"?window.location.host:"datebook"},$=function(a){var r,n,t={FREQ:a.frequency,INTERVAL:(r=a.interval)===null||r===void 0?void 0:r.toString(),COUNT:(n=a.count)===null||n===void 0?void 0:n.toString(),WKST:a.weekstart,BYDAY:a.weekdays,BYMONTHDAY:a.monthdays};return a.end&&(t.UNTIL=o.formatDate(a.end,c.FULL)),f.toIcsParamString(t)},l={formatText:G,getUid:Q,getProdId:Z,getRrule:$};(function(a){y(r,a);function r(n){var t=a.call(this,n)||this;return t.setInitialParams=function(){var e=c.DATE;t.isAllDay||(e+=c.TIME);var i=[o.formatDate(t.start,e),o.formatDate(t.end,e)].join("/");t.setParam("action","TEMPLATE").setParam("dates",i).setParam("text",t.title).setParam("details",t.description).setParam("location",t.location).setParam("allday",t.isAllDay.toString()),t.recurrence&&t.setParam("recur","RRULE:".concat(l.getRrule(t.recurrence))),t.attendees.length>0&&t.setParam("add",f.toMailtoList(t.attendees).join(","))},t.render=function(){var e=p.GOOGLE,i=f.toQueryString(t.params);return"".concat(e,"?").concat(i)},t.setInitialParams(),t}return r})(D);(function(a){y(r,a);function r(n){var t=a.call(this,n)||this;return t.setInitialParams=function(){t.setParam("v","60").setParam("title",t.title).setParam("desc",t.description).setParam("in_loc",t.location),t.setTimeParams(),t.attendees.length>0&&t.setParam("inv_list",f.toMailtoList(t.attendees).join(","))},t.setTimeParams=function(){t.isAllDay?t.setParam("dur","allday").setParam("st",o.formatDateNoUtc(t.start,c.DATE)):(t.setParam("st",o.formatDateNoUtc(t.start,c.NO_UTC_FULL)),o.getHoursDiff(t.start.getTime(),t.end.getTime())>99?t.setParam("et",o.formatDateNoUtc(t.end,c.NO_UTC_FULL)):t.setParam("dur",o.getDuration(t.start.getTime(),t.end.getTime())))},t.render=function(){var e=p.YAHOO,i=f.toQueryString(t.params);return"".concat(e,"?").concat(i)},t.setInitialParams(),t}return r})(D);(function(a){y(r,a);function r(n){var t=a.call(this,n)||this;return t.baseUrl=p.OUTLOOK,t.setInitialParams=function(){var e=c.OUTLOOK_DATE;t.isAllDay||(e+=c.OUTLOOK_TIME),t.setParam("rru","addevent").setParam("path","/calendar/action/compose").setParam("startdt",o.formatDate(t.start,e)).setParam("enddt",o.formatDate(t.end,e)).setParam("subject",t.title).setParam("body",t.description).setParam("location",t.location).setParam("allday",t.isAllDay.toString()),t.attendees.length>0&&t.setParam("to",f.toMailtoList(t.attendees).join(","))},t.setHost=function(e){return["live","office"].includes(e)&&(t.baseUrl=p.OUTLOOK.replace("{{host}}",e)),t},t.render=function(){var e=f.toQueryString(t.params);return"".concat(t.baseUrl,"?").concat(e)},t.setInitialParams(),t.setHost("live"),t}return r})(D);var W=function(a){y(r,a);function r(n){var t=a.call(this,n)||this;return t.additionalEvents=[],t.properties=[],t.meta={},t.setInitialParams=function(){t.setMeta("UID",l.getUid()).setMeta("DTSTAMP",o.getTimeCreated()).addProperty("CLASS","PUBLIC").addProperty("DESCRIPTION",l.formatText(t.description)).addProperty("LOCATION",l.formatText(t.location)).addProperty("SUMMARY",l.formatText(t.title)).addProperty("TRANSP","TRANSPARENT"),t.isAllDay?t.addProperty("DTSTART;VALUE=DATE",o.formatDateNoUtc(t.start,c.DATE)).addProperty("DTEND;VALUE=DATE",o.formatDateNoUtc(o.incrementDate(t.start,1),c.DATE)):t.addProperty("DTSTART",o.formatDate(t.start,c.FULL)).addProperty("DTEND",o.formatDate(t.end,c.FULL)),t.recurrence&&t.addProperty("RRULE",l.getRrule(t.recurrence)),t.attendees.length>0&&t.attendees.forEach(function(e){var i=e.email,s=e.name,m=e.icsOptions,E=m===void 0?{}:m,U=t.getAttendeeParams(E,s),L="MAILTO:".concat(i);t.addProperty(U,L)})},t.getAttendeeParams=function(e,i){var s={};i&&(s.CN=i),e.delegatedFrom&&(s["DELEGATED-FROM"]=e.delegatedFrom),e.partStat&&(s.PARTSTAT=e.partStat),e.role&&(s.ROLE=e.role),e.sentBy&&(s["SENT-BY"]=e.sentBy),s.RSVP=e.rsvp?"TRUE":"FALSE";var m=f.toParamString(s,";");return"ATTENDEE;".concat(m)},t.getAlarmDuration=function(e){var i=["".concat(e.weeks,"W"),"".concat(e.days,"D"),"".concat(e.hours,"H"),"".concat(e.minutes,"M"),"".concat(e.seconds,"S")].filter(function(s){return/^[0-9]+[A-Z]$/.exec(s)});return i.unshift(e.after?"PT":"-PT"),i.join("")},t.getMeta=function(){return Object.keys(t.meta).map(function(e){return"".concat(e,":").concat(t.meta[e])})},t.setMeta=function(e,i){return t.meta[e]=i,t},t.addEvent=function(e){return t.additionalEvents.push(e),t},t.addProperty=function(e,i){if(typeof i=="object"){t.properties.push("BEGIN:".concat(e));for(var s in i)t.addProperty(s,i[s]);t.properties.push("END:".concat(e))}else t.properties.push("".concat(e,":").concat(i.toString()));return t},t.addAlarm=function(e){var i={ACTION:e.action};if(e.description&&(i.DESCRIPTION=l.formatText(e.description)),e.summary&&(i.SUMMARY=l.formatText(e.summary)),e.duration&&(i.DURATION=t.getAlarmDuration(e.duration)),e.repeat&&(i.REPEAT=e.repeat),e.attach){var s=e.attach.params?"ATTACH;".concat(e.attach.params):"ATTACH";i[s]=e.attach.url}return e.trigger instanceof Date?i["TRIGGER;VALUE=DATE-TIME"]=o.formatDate(e.trigger,c.FULL):i.TRIGGER=t.getAlarmDuration(e.trigger),t.addProperty("VALARM",i)},t.render=function(){var e=u([t],t.additionalEvents,!0),i=e.reduce(function(s,m){return u(u(u(u(u([],s,!0),["BEGIN:VEVENT"],!1),m.properties,!0),m.getMeta(),!0),["END:VEVENT"],!1)},[]);return u(u(["BEGIN:VCALENDAR","VERSION:2.0"],i,!0),["PRODID:".concat(l.getProdId()),"END:VCALENDAR"],!1).join(`
`)},t.setInitialParams(),t}return r}(D);const P=C({name:"CalendarButton",components:{BaseButton:N},props:{isAllDay:{type:Boolean,required:!1,default:!1},startDate:{type:String,default:void 0},startDatetime:{type:String,default:void 0},endDatetime:{type:String,required:!1,default:void 0},title:{type:String,required:!1,default:void 0},location:{type:String,required:!1,default:void 0},description:{type:String,required:!1,default:void 0}},data(){return{icalendar:void 0,options:void 0}},computed:{icsDescription(){return`${(this.description?this.description+`

`:"")+(window==null?void 0:window.location.href)}`}},mounted(){this.init()},methods:{init(){let a;if(this.isAllDay&&this.endDatetime||this.startDate&&this.endDatetime){const r=this.startDatetime?g(this.startDatetime):g(this.startDate).tz("America/Los_Angeles");a={frequency:"DAILY",interval:1,count:g(this.endDatetime).diff(r,"day")+1}}this.options={title:this.title?this.title:void 0,location:this.location?this.location:void 0,description:this.icsDescription,start:this.startDatetime?new Date(g(this.startDatetime)):this.startDate?new Date(g(this.startDate).tz("America/Los_Angeles")):new Date,end:!this.isAllDay&&this.endDatetime?new Date(this.endDatetime):void 0,recurrence:a},this.icalendar=new W(this.options)},handleDownload(){const a=this.icalendar.render(),r=new Blob([a],{type:"text/calendar"}),n=window.URL.createObjectURL(r);let t=document.createElement("a");t.href=n,t.download=b.kebabCase(this.title),t.click()}}});function z(a,r,n,t,e,i){const s=S("BaseButton");return I(),Y(s,{ref:"CalendarButton",class:"w-full",variant:"secondary",compact:"",onClick:a.handleDownload},{default:R(()=>r[0]||(r[0]=[M(" Add to calendar ")])),_:1},8,["onClick"])}const et=O(P,[["render",z]]);P.__docgenInfo={exportName:"default",displayName:"CalendarButton",type:1,props:[{name:"description",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:"undefined"},{name:"title",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:"undefined"},{name:"startDate",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:"undefined"},{name:"startDatetime",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:"undefined"},{name:"endDatetime",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:"undefined"},{name:"location",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:"undefined"},{name:"isAllDay",global:!1,description:"Used to generate ICS file",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]},default:"false"},{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void"}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"description",type:"string",description:"Used to generate ICS file",declarations:[],schema:"string"},{name:"title",type:"string",description:"Used to generate ICS file",declarations:[],schema:"string"},{name:"startDate",type:"string",description:"Used to generate ICS file",declarations:[],schema:"string"},{name:"startDatetime",type:"string",description:"Used to generate ICS file",declarations:[],schema:"string"},{name:"endDatetime",type:"string",description:"Used to generate ICS file",declarations:[],schema:"string"},{name:"location",type:"string",description:"Used to generate ICS file",declarations:[],schema:"string"},{name:"isAllDay",type:"boolean",description:"Used to generate ICS file",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"icalendar",type:"any",description:"",declarations:[],schema:"any"},{name:"options",type:"{ description?: string; title?: string; location?: string; start: Date; end?: Date; recurrence?: { frequency?: string; interval?: number; count?: number; end?: Date; weekstart?: string; weekdays?: string[]; monthdays?: number[]; month?: number; }; attendees?: { ...; }[]; }",description:"",declarations:[],schema:"{ description?: string; title?: string; location?: string; start: Date; end?: Date; recurrence?: { frequency?: string; interval?: number; count?: number; end?: Date; weekstart?: string; weekdays?: string[]; monthdays?: number[]; month?: number; }; attendees?: { ...; }[]; }"},{name:"icsDescription",type:"string",description:"",declarations:[],schema:"string"}],sourceFiles:"/home/runner/work/explorer-1/explorer-1/packages/vue/src/components/CalendarButton/CalendarButton.vue"};export{et as C};
