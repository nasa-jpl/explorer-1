import{Z as C,c as L,f as E,q as f,g as I,h as n,i,F as k,s as b,y as _,m as v,p as y,z as K,n as F,C as T,o,J as q,K as N,_ as P,H as V,t as d,j as O,w as G,a9 as A,L as M}from"./iframe-9cocL7nB.js";import{_ as j}from"./_baseIsEqual-ZsNmJoVN.js";import{l as D}from"./lookupContentType-BLOvub8k.js";import{l as H}from"./lodash-m3JaSfaN.js";import{I as U,a as z}from"./IconMinus-DcAi3aZ4.js";import"./preload-helper-D6kgxu3v.js";import"./_getTag-ZZcNRRZU.js";import"./isObjectLike-Dmpw8pC2.js";import"./constants-KGHeBXa6.js";var Q=j;function J(a,t){return Q(a,t)}var R=J;const Z=C(R),W={class:"SearchFilterGroupAccordionItemHeader flex flex-row w-full content-between"},X=["aria-expanded"],Y={class:"SearchFilterGroupAccordionItem-icon inline-block text-xs text-action flex-shrink-0"},$={class:"SearchFilterGroupAccordionItemContent text-sm"},ee={role:"region",class:"SearchFilterGroupAccordionItem-panel border-b border-gray-light-mid"},w=L({__name:"SearchFilterGroupAccordionItem",props:{initOpen:{type:Boolean,default:!1}},emits:["filterGroupAccordionItemOpened","filterGroupAccordionItemClosed"],setup(a,{emit:t}){const s=a,{initOpen:g}=E(s),l=f(!1),r=f(!g),u=f(H.uniqueId()),m=I(()=>`filterGroup_accordion_panel_${u.value}`),e=I(()=>`filterGroup_accordion_heading_${u.value}`),h=()=>{l.value=!l.value,r.value=!r.value,r.value?c("filterGroupAccordionItemClosed"):c("filterGroupAccordionItemOpened")},c=t;return(p,x)=>{const S=T("bind-once");return o(),n("div",{class:F(["SearchFilterGroupAccordionItem border-t pt-[0.4375rem]",{"-open border-gray-light-mid  -mb-px":!r.value,"border-transparent mb-2.5":r.value}])},[i("div",W,[p.$slots.header?(o(),n(k,{key:0},[b(p.$slots,"header"),_((o(),n("button",{"aria-expanded":l.value,"aria-label":"Expand",class:"SearchFilterGroupAccordionItem-trigger group block w-auto text-body-lg pl-4 pr-1 -my-2",onClick:x[0]||(x[0]=fe=>h())},[i("span",Y,[r.value?(o(),v(U,{key:0})):(o(),v(z,{key:1}))])],8,X)),[[S,{id:e.value,"aria-controls":m.value}]])],64)):y("",!0)]),_(i("div",$,[_((o(),n("div",ee,[b(p.$slots,"default")])),[[S,{id:m.value,"aria-labelledby":e.value}]])],512),[[K,!r.value]])],2)}}});w.__docgenInfo={exportName:"default",displayName:"SearchFilterGroupAccordionItem",description:"",tags:{},props:[{name:"initOpen",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"filterGroupAccordionItemOpened"},{name:"filterGroupAccordionItemClosed"}],slots:[{name:"header"},{name:"default"}],sourceFiles:["/home/runner/work/explorer-1/explorer-1/apps/vue-storybook/node_modules/@explorer-1/vue/src/components/SearchFilterGroupAccordionItem/SearchFilterGroupAccordionItem.vue"]};const B={name:"SearchFilterGroup",components:{SearchFilterGroupAccordionItem:w},props:{filterBy:{type:Array,default:void 0},buckets:{type:Object,default:void 0},hideFilterGroups:{type:Array,default:()=>[]},groupKey:{type:String,required:!0},groupTitle:{type:String,default:""},truncateFilters:{type:Boolean,required:!1,default:!1},subFilters:{type:Object,default:void 0},subFilterAggKey:{type:String,default:void 0},styleAsAccordion:{type:Boolean,default:!1}},emits:["update:filterBy"],data(){return{checkbox:{checkboxLimit:4,showMore:!0,initialLimit:4}}},computed:{...q(N),filterByHandler:{get(){return this.filterBy},set(a){this.$emit("update:filterBy",a)}},bucketsLength(){return this.buckets.length},showFilterGroup(){var a;return this.themeStore.isEdu?(this.groupTitle||((a=this.buckets)==null?void 0:a.length))&&!this.hideFilterGroups.includes(this.groupKey):typeof this.groupKey<"u"&&typeof this.buckets<"u"&&this.bucketsLength>=1&&!this.hideFilterGroups.includes(this.groupKey)},subFilterParentKeys(){return this.subFilters?Object.keys(this.subFilters):void 0}},watch:{filterBy:{handler(a,t){if(!Z(a,t)){let s=Object.assign({},this.$route.query);a.length>0?s={...this.$route.query,page:1,[this.groupKey]:a.toString()}:delete s[this.groupKey],this.$router.push({query:s})}}}},methods:{generateId(a,t){let s=String(a);return s=s.split(" ").join(""),`filter_${t}_${s}`},getSubFilterParentKey(a){let t=a;return t&&(t=t.toLowerCase(),t=t.replaceAll(" ","_")),t},hasSubFilters(a){const t=this.getSubFilterParentKey(a);if(this.subFilters&&t&&this.subFilters[t])return!0},subFilterIsInQueryParams(a){const t=this.getSubFilters(a);let s=!1;return t!=null&&t.length&&t.forEach(g=>{var u;const l=g.agg,r=g.key;l&&r&&((u=this.$route.query[l])!=null&&u.includes(r))&&(s=!0)}),s},getSubFilters(a){const t=this.getSubFilterParentKey(a);if(this.subFilters&&t&&this.subFilters[t])return this.subFilters[t]},toggleShowMoreFilters(){this.checkbox.checkboxLimit===this.checkbox.initialLimit?(this.checkbox.checkboxLimit=1/0,this.checkbox.showMore=!1,this.$nextTick(()=>{this.$refs.buckets[this.checkbox.initialLimit].getElementsByTagName("input")[0].focus()})):(this.checkbox.checkboxLimit=this.checkbox.initialLimit,this.checkbox.showMore=!0)},prettyFilterNames(a){let t=D(a,"model","label");return this.themeStore.isEdu&&t&&(t=t.replace("EDU ","")),t||a},getSlotName(a){return`slot_${a}`}}},te=["id"],re={class:"md:mb-3 text-body-md mb-2 font-bold leading-normal tracking-wide"},se={key:0,class:"buckets"},ae={key:0,class:"flex flex-grow"},oe=["id","value"],ie=["for"],ne={class:"font-extrabold"},le={class:"text-gray-mid-dark font-normal text-sm"},ce={key:0,class:"block"},ue={key:0,class:"SubFilters"},de=["id","value"],ye=["for"],_e={class:"text-gray-mid-dark text-sm font-normal"},ge={key:1},me=["aria-expanded","aria-controls"];function he(a,t,s,g,l,r){var m;const u=V("SearchFilterGroupAccordionItem");return r.showFilterGroup?(o(),n("div",{key:0,id:`filterGroup_${s.groupKey}`,class:"border-gray-light-mid col-span-3 pb-4 mb-4 border-b"},[i("legend",re,d(s.groupTitle),1),(m=s.buckets)!=null&&m.length?(o(),n("div",se,[(o(!0),n(k,null,O(s.buckets,(e,h)=>(o(),n("div",{key:e.key,ref_for:!0,ref:"buckets",class:"form-group form-check"},[r.hasSubFilters(e.key_as_string||e.key)?(o(),v(u,{key:0,class:"w-auto","init-open":r.subFilterIsInQueryParams(e.key_as_string||e.key)},{header:G(()=>[!s.truncateFilters||h<=l.checkbox.checkboxLimit-1?(o(),n("div",ae,[_(i("input",{id:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),"onUpdate:modelValue":t[0]||(t[0]=c=>r.filterByHandler=c),type:"checkbox",value:e.key_as_string?e.key_as_string:e.key,class:"text-primary focus:ring-2 focus:ring-primary flex-shrink-0 w-5 h-5 mt-px mr-1 align-middle border rounded-none"},null,8,oe),[[A,r.filterByHandler]]),i("label",{for:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),class:"form-check-label pl-2 tracking-normal align-middle"},[i("span",ne,d(r.prettyFilterNames(e.key_as_string?e.key_as_string:e.key)),1),i("span",le," ("+d(e.doc_count.toLocaleString())+") ",1)],8,ie)])):y("",!0)]),default:G(()=>{var c;return[(e.key_as_string||e.key)&&r.getSubFilters(e.key_as_string||e.key)&&((c=r.subFilterParentKeys)!=null&&c.length)?(o(),n("div",ce,[r.hasSubFilters(e.key_as_string||e.key)?(o(),n("div",ue,[b(a.$slots,`slot_${r.getSubFilterParentKey(e.key_as_string||e.key)}`)])):y("",!0)])):y("",!0)]}),_:2},1032,["init-open"])):(o(),n(k,{key:1},[!s.truncateFilters||h<=l.checkbox.checkboxLimit-1?(o(),n("div",{key:0,class:F(["flex",{"pt-2 mt-2 mb-3":s.styleAsAccordion,"my-2":!s.styleAsAccordion}])},[_(i("input",{id:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),"onUpdate:modelValue":t[1]||(t[1]=c=>r.filterByHandler=c),type:"checkbox",value:e.key_as_string?e.key_as_string:e.key,class:"text-primary focus:ring-2 focus:ring-primary flex-shrink-0 w-5 h-5 mt-px mr-1 align-middle border rounded-none"},null,8,de),[[A,r.filterByHandler]]),i("label",{for:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),class:F(["form-check-label pl-2 tracking-normal align-middle",{"font-extrabold":s.styleAsAccordion}])},[M(d(r.prettyFilterNames(e.key_as_string?e.key_as_string:e.key))+" ",1),i("span",_e," ("+d(e.doc_count.toLocaleString())+") ",1)],10,ye)],2)):y("",!0)],64))]))),128))])):(o(),n("div",ge,t[3]||(t[3]=[i("span",{class:"text-sm text-gray-mid-dark"},"No matching filters",-1)]))),_(i("div",null,[i("button",{class:"can-hover:hover:underline text-action mt-2","aria-expanded":l.checkbox.showMore?"false":"true","aria-haspopup":"true","aria-controls":`filterGroup_${s.groupKey}`,onClick:t[2]||(t[2]=e=>r.toggleShowMoreFilters())},d(l.checkbox.showMore==!1?"Less":"More"),9,me)],512),[[K,s.truncateFilters&&r.bucketsLength>l.checkbox.initialLimit]])],8,te)):y("",!0)}const pe=P(B,[["render",he]]);B.__docgenInfo={displayName:"SearchFilterGroup",exportName:"default",description:"",tags:{},props:[{name:"filterBy",type:{name:"array"},defaultValue:{func:!1,value:"undefined"}},{name:"buckets",type:{name:"object"},defaultValue:{func:!1,value:"undefined"}},{name:"hideFilterGroups",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"groupKey",type:{name:"string"},required:!0},{name:"groupTitle",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"truncateFilters",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"subFilters",type:{name:"SubFiltersObject"},defaultValue:{func:!1,value:"undefined"}},{name:"subFilterAggKey",type:{name:"string"},defaultValue:{func:!1,value:"undefined"}},{name:"styleAsAccordion",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"update:filterBy",type:{names:["undefined"]}}],slots:[{name:"`slot_${getSubFilterParentKey(bucket.key_as_string || bucket.key)}`",scoped:!0,bindings:[{name:"name",title:"binding"}]}],sourceFiles:["/home/runner/work/explorer-1/explorer-1/apps/vue-storybook/node_modules/@explorer-1/vue/src/components/SearchFilterGroup/SearchFilterGroup.vue"]};const Ke={title:"Components/Search/SearchFilterGroup",component:pe,excludeStories:/.*Data$/},we={name:"Topic Filter",args:{filterBy:[],buckets:[{key:"Solar System",doc_count:3308},{key:"Earth",doc_count:1179},{key:"Stars and Galaxies",doc_count:979},{key:"Technology",doc_count:480}],groupKey:"topics",groupTitle:"Topic",truncateFilters:!1}},Be={args:{filterBy:[],buckets:[{key_as_string:"2021",key:16094592e5,doc_count:5},{key_as_string:"2020",key:15778368e5,doc_count:231},{key_as_string:"2019",key:15463008e5,doc_count:245},{key_as_string:"2018",key:15147648e5,doc_count:276},{key_as_string:"2017",key:14832288e5,doc_count:314},{key_as_string:"2016",key:14516064e5,doc_count:311},{key_as_string:"2015",key:14200704e5,doc_count:377},{key_as_string:"2014",key:13885344e5,doc_count:418},{key_as_string:"2013",key:13569984e5,doc_count:358},{key_as_string:"2012",key:1325376e6,doc_count:389},{key_as_string:"2011",key:129384e7,doc_count:367},{key_as_string:"2010",key:1262304e6,doc_count:389},{key_as_string:"2009",key:1230768e6,doc_count:172},{key_as_string:"2008",key:11991456e5,doc_count:227}],groupKey:"results_by_year",groupTitle:"Date",truncateFilters:!0}},Ce={decorators:[()=>({template:'<div id="storyRoot" class="md:w-1/2 lg:w-1/3"><story /></div>'})],args:{filterBy:[],buckets:[{key:"Solar System",doc_count:3308},{key:"Earth",doc_count:1179},{key:"Stars and Galaxies",doc_count:979},{key:"Technology",doc_count:480}],groupKey:"topics",groupTitle:"Topic",truncateFilters:!1,subFilters:{solar_system:[{key:"Sun",agg:"solar_system_area",doc_count:20},{key:"Mercury",agg:"solar_system_area",doc_count:21},{key:"Venus",agg:"solar_system_area",doc_count:22}],earth:[{key:"Sea Level",agg:"solar_system_area",doc_count:20},{key:"Pollution",agg:"solar_system_area",doc_count:21},{key:"Climate Change",agg:"solar_system_area",doc_count:22}],stars_and_galaxies:[{key:"Sea Level",agg:"solar_system_area",doc_count:20},{key:"Pollution",agg:"solar_system_area",doc_count:21},{key:"Climate Change",agg:"solar_system_area",doc_count:22}],technology:[{key:"Sea Level",agg:"solar_system_area",doc_count:20},{key:"Pollution",agg:"solar_system_area",doc_count:21},{key:"Climate Change",agg:"solar_system_area",doc_count:22}]}}},Le=["BaseStory","DateFilter","SubFilters"];export{we as BaseStory,Be as DateFilter,Ce as SubFilters,Le as __namedExportsOrder,Ke as default};
