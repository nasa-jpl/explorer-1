import{c as w,_ as P,H as n,o as a,h as o,i,l,$ as I,p as h,t as p,n as x}from"./iframe-DnG6RETX.js";import{I as k}from"./IconPlay-Dv1FhG6K.js";import{I as V,a as B,b as M,c as A,d as S}from"./IconForwardTen-CAGsPiYQ.js";const T=10,$=()=>"xxxxxxxx-xxxx-4xxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),m=e=>{const t=new Date(e*1e3).toISOString().substr(11,8);return t.indexOf("00:")===0?t.substr(3):t},c=w({name:"BaseAudio",components:{IconPlay:k,IconPause:V,IconVolume:B,IconMute:M,IconRewindTen:A,IconForwardTen:S},props:{file:{type:String,default:null},autoPlay:{type:Boolean,default:!1}},data(){return{firstPlay:!0,isMuted:!1,loaded:!1,playing:!1,paused:!0,progressStyle:"",currentTime:"00:00",uuid:"0",audio:void 0,totalDuration:0,hideVolumeSlider:!1,volumeValue:T}},computed:{duration(){return this.audio?m(this.totalDuration):""},playerId(){return"player-"+this.uuid}},mounted(){this.uuid=$(),this.audio=this.getAudio(),this.init()},beforeUnmount(){this.audio&&(this.audio.removeEventListener("timeupdate",this._handlePlayingUI),this.audio.removeEventListener("loadeddata",this._handleLoaded),this.audio.removeEventListener("pause",this._handlePlayPause),this.audio.removeEventListener("play",this._handlePlayPause))},methods:{setPosition:function(t){if(this.audio){const u=t.target;if(this.paused||t.target.tagName==="SPAN")return;const d=u.getBoundingClientRect(),r=(t.clientX-d.left)/d.width;this.audio.currentTime=this.audio.duration*r}},updateVolume(){this.audio&&(this.hideVolumeSlider=!1,this.audio.volume=this.volumeValue/100,this.volumeValue/100>0&&(this.isMuted=this.audio.muted=!1),this.volumeValue/100===0&&(this.isMuted=this.audio.muted=!0))},toggleVolume(){this.hideVolumeSlider=!0},stop(){this.audio&&(this.playing=!1,this.paused=!0,this.audio.pause(),this.audio.currentTime=0)},play(){var e;this.playing&&!this.paused||this.audio&&(this.paused=!1,this.audio.play(),this.playing=!0,(e=this.$root)==null||e.$emit("play",this.uuid))},forward(e){return this.audio?this.audio.currentTime+=e:void 0},rewind(e){return this.audio?this.audio.currentTime-=e:void 0},pause(){this.audio&&(this.paused=!this.paused,this.paused?this.audio.pause():this.audio.play())},pauseOthers(e){this.audio&&this.uuid!==e&&(this.paused=!0,this.audio.pause())},toggleMute(){this.audio&&(this.isMuted=!this.isMuted,this.audio.muted=this.isMuted,this.volumeValue=this.isMuted?0:100)},_handleLoaded(){if(this.audio&&this.audio.readyState>=2)this.autoPlay&&this.play(),this.loaded=!0,this.totalDuration=this.audio.duration;else throw new Error("Failed to load audio file")},_handlePlayingUI(e){if(this.audio){const t=this.audio.currentTime,u=t/this.totalDuration*100;this.progressStyle=`width: ${u}%;`,this.currentTime=m(t)}},_handlePlayPause(e){this.audio&&e.type==="play"&&this.firstPlay&&(this.audio.currentTime=0,this.firstPlay&&(this.firstPlay=!1)),e.type==="pause"&&this.playing===!1&&(this.progressStyle="width:0%",this.currentTime="00:00",this.paused=!0)},_handleEnded(){this.paused=this.playing=!1},init(){this.audio&&(this.audio.addEventListener("timeupdate",this._handlePlayingUI),this.audio.addEventListener("loadeddata",this._handleLoaded),this.audio.addEventListener("pause",this._handlePlayPause),this.audio.addEventListener("play",this._handlePlayPause),this.audio.addEventListener("ended",this._handleEnded))},getAudio(){return this.$el.querySelectorAll("audio")[0]}}}),E={class:"BaseAudio"},C={class:"BaseAudio__stage sm:pr-5"},L={class:"BaseAudio__player w-full select-none"},F={class:"flex flex-row w-full"},U={class:"z-30 text-sm md:text-base"},D={class:"flex flex-col w-full z-20"},N={class:"flex flex-row text-white"},R={class:"flex flex-row justify-between w-full py-1.5 px-3"},j={class:"BaseAudio__playback-time-current text-sm md:text-base pr-1 md:pr-3 text-left"},z={key:0,class:"BaseAudio__rewind-forward animate-fadeIn"},H={class:"BaseAudio__playback-time-total"},O=["id","src"];function q(e,t,u,d,r,X){const f=n("IconPlay"),y=n("IconPause"),g=n("IconRewindTen"),v=n("IconForwardTen"),_=n("IconMute"),b=n("IconVolume");return a(),o("div",E,[i("div",C,[i("div",L,[i("div",F,[i("div",U,[e.paused?(a(),o("button",{key:0,class:"cursor-pointer",title:"Play","aria-label":"Play",onClick:t[0]||(t[0]=s=>e.play())},[l(f,{class:"bg-jpl-red text-white"})])):(a(),o("button",{key:1,class:"cursor-pointer",title:"Pause","aria-label":"Pause",onClick:t[1]||(t[1]=s=>e.pause())},[l(y,{class:"bg-jpl-red text-white"})]))]),i("div",D,[i("div",{class:"BaseAudio__playback-time-wrapper cursor-pointer relative inline-block w-full border-t border-jpl-red bg-gray-mid-dark bg-opacity-25 h-2",title:"Playback Position",onClick:t[2]||(t[2]=(...s)=>e.setPosition&&e.setPosition(...s))},[e.playing?(a(),o("div",{key:0,style:I(e.progressStyle),class:"BaseAudio__playback-time-indicator bg-jpl-red transition-all transform-gpu duration-50 absolute top-0 left-0 bottom-0 h-2"},null,4)):h("",!0)]),i("div",N,[i("div",R,[i("span",j,p(e.currentTime),1),e.playing?(a(),o("div",z,[i("button",{class:"cursor-pointer",title:"Rewind","aria-label":"Rewind 10 seconds",onClick:t[3]||(t[3]=s=>e.rewind(10))},[l(g)]),i("button",{class:"cursor-pointer",title:"Fast Forward","aria-label":"Fast-forward 10 seconds",onClick:t[4]||(t[4]=s=>e.forward(10))},[l(v)])])):h("",!0),i("span",H,p(e.duration),1)]),i("div",{class:x(["BaseAudio__extern-wrapper flex flex-row",e.playing?"-mt-1.5 sm:-mt-0.5 md:mt-0 lg:-mt-0.5":"-mt-1.5 sm:mt-0.5 md:mt-1 lg:mt-1.5"])},[e.isMuted?(a(),o("button",{key:0,class:"cursor-pointer",title:"Unmute","aria-label":"Unmute",onClick:t[5]||(t[5]=s=>e.toggleMute())},[l(_)])):(a(),o("button",{key:1,class:"cursor-pointer",title:"Mute","aria-label":"Mute",onClick:t[6]||(t[6]=s=>e.toggleMute())},[l(b)]))],2)])])])]),i("audio",{id:e.playerId,ref:"player",src:e.file,preload:"auto",class:"hidden min-w-full left-0 right-0"},null,8,O)]),i("a",{class:"volume-toggle absolute right-5 -bottom-4",title:"Volume",onMouseover:t[7]||(t[7]=s=>e.toggleVolume())},null,32)])}const Q=P(c,[["render",q]]);c.__docgenInfo={displayName:"BaseAudio",exportName:"default",description:"",tags:{},props:[{name:"file",type:{name:"string"},defaultValue:{func:!1,value:"null"}},{name:"autoPlay",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/explorer-1/explorer-1/apps/vue-storybook/node_modules/@explorer-1/vue/src/components/BaseAudio/BaseAudio.vue"]};export{Q as B};
