import{d as v,B as D,S as d,_ as S,P as _,o as n,b as l,f as p,e as b,t as m,h as A,i as $,m as P,k as y}from"./iframe-CnvubKsn.js";import{B as k}from"./BaseTimer-BvhIjCcQ.js";const h={earth:"Distance from Earth",mars:"Distance traveled on Mars"},T={"/api/v1/missions/":{getPath:(e,t)=>{const s=e.split(t)[1];if(!s)throw console.error(e,t),new Error("Error querying /api/v1/missions/ API");return`/api/mars${t}${s}`},getDistance:e=>{if(typeof(e==null?void 0:e.mi_traveled)>"u")throw console.error(e),new Error("Error processing /api/v1/missions/ data");return{value:e.mi_traveled,system:"imperial"}}},"/spice_data/getRangefromT1/":{getPath:(e,t)=>{const i=e.split(t)[1].split("/"),a=`${i[0]}/${i[1]}/`,r=[d(),d().add(1,"minute")].map(o=>o.toISOString().replace(/\.\d+Z$/,"")).join("/");return`/api/mars/spice_data/getRangefromT1/${a}${r}/1/`},getDistance:(e,t)=>{var i;const s=(i=e==null?void 0:e.items[t])==null?void 0:i.value;if(e.error||e.units!=="KM"||typeof s>"u")throw console.error(e,t),new Error("Error processing /spice_data/getRangefromT1/ data");return{value:Math.round(Number(s)),system:"metric"}}}},u=Object.keys(T),w=v({name:"DistanceStats",components:{BaseUnitToggle:D},props:{distanceType:{type:String,required:!0,validator:e=>e===""||Object.keys(h).includes(e)},value:{type:Number,default:void 0},valueSystem:{type:String,required:!1,default:"imperial"},distanceApiUrls:{type:String,required:!1,validator:e=>u.some(t=>e.includes(t)||e===""),default:void 0},labelClass:{type:String,default:void 0}},data(){return{apiDistance:null,showError:!1,timeout:null}},computed:{distanceTypeLabel(){return h[this.distanceType]||this.distanceType},loadedValue(){var e;return this.distanceApiUrls?((e=this.apiDistance)==null?void 0:e.value)||0:this.value},loadedSystem(){var e;return this.distanceApiUrls?((e=this.apiDistance)==null?void 0:e.system)||"imperial":this.valueSystem},isLoading(){return!!this.distanceApiUrls&&this.apiDistance===null}},mounted(){this.distanceApiUrls&&this.getAPIDistance()},beforeUnmount(){clearTimeout(this.timeout)},methods:{async getAPIDistance(){try{const e=u.find(t=>{var s;return(s=this.distanceApiUrls)==null?void 0:s.includes(t)});if(e&&this.distanceApiUrls){const t=T[e],s=t.getPath(this.distanceApiUrls,e),i=await this.$axios.$get(s);e==="/spice_data/getRangefromT1/"?this.updateSPICEData(t,i,0):this.apiDistance=t.getDistance(i,0)}}catch(e){console.error(e),this.showError=!0}},async updateSPICEData(e,t,s){var a;this.apiDistance=e.getDistance(t,s);const i=s+1;if(i<((a=t==null?void 0:t.items)==null?void 0:a.length))this.timeout=setTimeout(this.updateSPICEData.bind(this,e,t,i),1e3);else if(this.distanceApiUrls){const r=await this.$axios.$get(e.getPath(this.distanceApiUrls,"/spice_data/getRangefromT1/"));this.updateSPICEData(e,r,0)}}}}),U={key:0,class:"DistanceStats"},q={key:0},E={key:1};function B(e,t,s,i,a,r){const o=_("BaseUnitToggle");return typeof e.value<"u"||e.distanceApiUrls?(n(),l("div",U,[p(e.$slots,"label",{label:e.distanceTypeLabel},()=>[b("p",null,m(e.distanceTypeLabel),1)]),e.showError?(n(),l("p",q,"Unavailable")):e.isLoading?(n(),l("p",E,"Loadingâ€¦")):e.loadedValue?(n(),A(o,{key:2,"unit-pair":"MI_KM",value:e.loadedValue,"value-system":e.loadedSystem},{default:$(c=>[p(e.$slots,"value",{formattedValue:c.formattedValue},()=>[P(m(c.formattedValue),1)])]),_:3},8,["value","value-system"])):y("",!0)])):y("",!0)}const C=S(w,[["render",B]]),f={draft:"Select status",current:"Current",future:"Future",proposed:"Proposed",past:"Past"},g={countdown:"Countdown",time_in_orbit:"Time in Orbit",time_on_mars:"Time on Mars",time_to_mars:"Time to Mars",time_to_dest:"Time to Destination"},M=v({name:"MissionDetailStats",components:{BaseTimer:k,DistanceStats:C},props:{showClock:Boolean,clockType:{type:String,required:!0,validator:e=>!!g[e]},startDateTime:{type:String,required:!1,default:void 0},displayDate:{type:String||null,required:!1,default:void 0},missionTypes:{type:Array,required:!0,default:()=>[]},missionTargets:{type:Array,required:!0,default:()=>[]},status:{type:String,required:!0,validator:e=>!!f[e]},showDistance:Boolean,distanceType:{type:String,required:!1,default:""},distanceValue:{type:Number,default:void 0},distanceApiUrls:{type:String,default:void 0,validator:e=>u.some(t=>e.includes(t)||e==="")}},computed:{clockTypeLabel(){return g[this.clockType]||this.clockType},statusLabel(){return f[this.status]||this.status}}});export{C as D,M as _,g as c};
