import{Z as w,d as B,r as L,a as f,c as I,b as n,e as i,F as p,f as b,w as _,h as x,k as y,v as A,n as F,g as C,o as a,T as E,q as T,_ as q,P,t as u,L as M,i as G,a7 as K,m as D}from"./iframe-CnvubKsn.js";import{_ as N}from"./_baseIsEqual-DlwFoRoh.js";import{l as O}from"./lookupContentType-BLOvub8k.js";import{l as H}from"./lodash-SOVn8Woo.js";import{I as j,a as V}from"./IconMinus-nA-On4yj.js";import"./preload-helper-D6kgxu3v.js";import"./_getTag-DBfb7C0d.js";import"./isObjectLike-Bk3woBvz.js";import"./constants-KGHeBXa6.js";var U=N;function Q(o,t){return U(o,t)}var z=Q;const R=w(z),Z={class:"SearchFilterGroupAccordionItemHeader flex flex-row w-full content-between"},J=["aria-expanded"],W={class:"SearchFilterGroupAccordionItem-icon inline-block text-xs text-action flex-shrink-0"},X={class:"SearchFilterGroupAccordionItemContent text-sm"},Y={role:"region",class:"SearchFilterGroupAccordionItem-panel border-b border-gray-light-mid"},$=B({__name:"SearchFilterGroupAccordionItem",props:{initOpen:{type:Boolean,default:!1}},emits:["filterGroupAccordionItemOpened","filterGroupAccordionItemClosed"],setup(o,{emit:t}){const s=o,{initOpen:g}=L(s),l=f(!1),r=f(!g),d=f(H.uniqueId()),h=I(()=>`filterGroup_accordion_panel_${d.value}`),e=I(()=>`filterGroup_accordion_heading_${d.value}`),m=()=>{l.value=!l.value,r.value=!r.value,r.value?c("filterGroupAccordionItemClosed"):c("filterGroupAccordionItemOpened")},c=t;return(k,v)=>{const S=C("bind-once");return a(),n("div",{class:F(["SearchFilterGroupAccordionItem border-t pt-[0.4375rem]",{"-open border-gray-light-mid  -mb-px":!r.value,"border-transparent mb-2.5":r.value}])},[i("div",Z,[k.$slots.header?(a(),n(p,{key:0},[b(k.$slots,"header"),_((a(),n("button",{"aria-expanded":l.value,"aria-label":"Expand",class:"SearchFilterGroupAccordionItem-trigger group block w-auto text-body-lg pl-4 pr-1 -my-2",onClick:v[0]||(v[0]=fe=>m())},[i("span",W,[r.value?(a(),x(j,{key:0})):(a(),x(V,{key:1}))])],8,J)),[[S,{id:e.value,"aria-controls":h.value}]])],64)):y("",!0)]),_(i("div",X,[_((a(),n("div",Y,[b(k.$slots,"default")])),[[S,{id:h.value,"aria-labelledby":e.value}]])],512),[[A,!r.value]])],2)}}}),ee={name:"SearchFilterGroup",components:{SearchFilterGroupAccordionItem:$},props:{filterBy:{type:Array,default:void 0},buckets:{type:Object,default:void 0},hideFilterGroups:{type:Array,default:()=>[]},groupKey:{type:String,required:!0},groupTitle:{type:String,default:""},truncateFilters:{type:Boolean,required:!1,default:!1},subFilters:{type:Object,default:void 0},subFilterAggKey:{type:String,default:void 0},styleAsAccordion:{type:Boolean,default:!1}},emits:["update:filterBy"],data(){return{checkbox:{checkboxLimit:4,showMore:!0,initialLimit:4}}},computed:{...E(T),filterByHandler:{get(){return this.filterBy},set(o){this.$emit("update:filterBy",o)}},bucketsLength(){return this.buckets.length},showFilterGroup(){var o;return this.themeStore.isEdu?(this.groupTitle||((o=this.buckets)==null?void 0:o.length))&&!this.hideFilterGroups.includes(this.groupKey):typeof this.groupKey<"u"&&typeof this.buckets<"u"&&this.bucketsLength>=1&&!this.hideFilterGroups.includes(this.groupKey)},subFilterParentKeys(){return this.subFilters?Object.keys(this.subFilters):void 0}},watch:{filterBy:{handler(o,t){if(!R(o,t)){let s=Object.assign({},this.$route.query);o.length>0?s={...this.$route.query,page:1,[this.groupKey]:o.toString()}:delete s[this.groupKey],this.$router.push({query:s})}}}},methods:{generateId(o,t){let s=String(o);return s=s.split(" ").join(""),`filter_${t}_${s}`},getSubFilterParentKey(o){let t=o;return t&&(t=t.toLowerCase(),t=t.replaceAll(" ","_")),t},hasSubFilters(o){const t=this.getSubFilterParentKey(o);if(this.subFilters&&t&&this.subFilters[t])return!0},subFilterIsInQueryParams(o){const t=this.getSubFilters(o);let s=!1;return t!=null&&t.length&&t.forEach(g=>{var d;const l=g.agg,r=g.key;l&&r&&((d=this.$route.query[l])!=null&&d.includes(r))&&(s=!0)}),s},getSubFilters(o){const t=this.getSubFilterParentKey(o);if(this.subFilters&&t&&this.subFilters[t])return this.subFilters[t]},toggleShowMoreFilters(){this.checkbox.checkboxLimit===this.checkbox.initialLimit?(this.checkbox.checkboxLimit=1/0,this.checkbox.showMore=!1,this.$nextTick(()=>{this.$refs.buckets[this.checkbox.initialLimit].getElementsByTagName("input")[0].focus()})):(this.checkbox.checkboxLimit=this.checkbox.initialLimit,this.checkbox.showMore=!0)},prettyFilterNames(o){let t=O(o,"model","label");return this.themeStore.isEdu&&t&&(t=t.replace("EDU ","")),t||o},getSlotName(o){return`slot_${o}`}}},te=["id"],re={class:"md:mb-3 text-body-md mb-2 font-bold leading-normal tracking-wide"},se={key:0,class:"buckets"},oe={key:0,class:"flex flex-grow"},ae=["id","value"],ie=["for"],ne={class:"font-extrabold"},le={class:"text-gray-mid-dark font-normal text-sm"},ce={key:0,class:"block"},de={key:0,class:"SubFilters"},ue=["id","value"],ye=["for"],_e={class:"text-gray-mid-dark text-sm font-normal"},ge={key:1},he=["aria-expanded","aria-controls"];function me(o,t,s,g,l,r){var h;const d=P("SearchFilterGroupAccordionItem");return r.showFilterGroup?(a(),n("div",{key:0,id:`filterGroup_${s.groupKey}`,class:"border-gray-light-mid col-span-3 pb-4 mb-4 border-b"},[i("legend",re,u(s.groupTitle),1),(h=s.buckets)!=null&&h.length?(a(),n("div",se,[(a(!0),n(p,null,M(s.buckets,(e,m)=>(a(),n("div",{key:e.key,ref_for:!0,ref:"buckets",class:"form-group form-check"},[r.hasSubFilters(e.key_as_string||e.key)?(a(),x(d,{key:0,class:"w-auto","init-open":r.subFilterIsInQueryParams(e.key_as_string||e.key)},{header:G(()=>[!s.truncateFilters||m<=l.checkbox.checkboxLimit-1?(a(),n("div",oe,[_(i("input",{id:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),"onUpdate:modelValue":t[0]||(t[0]=c=>r.filterByHandler=c),type:"checkbox",value:e.key_as_string?e.key_as_string:e.key,class:"text-primary focus:ring-2 focus:ring-primary flex-shrink-0 w-5 h-5 mt-px mr-1 align-middle border rounded-none"},null,8,ae),[[K,r.filterByHandler]]),i("label",{for:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),class:"form-check-label pl-2 tracking-normal align-middle"},[i("span",ne,u(r.prettyFilterNames(e.key_as_string?e.key_as_string:e.key)),1),i("span",le," ("+u(e.doc_count.toLocaleString())+") ",1)],8,ie)])):y("",!0)]),default:G(()=>{var c;return[(e.key_as_string||e.key)&&r.getSubFilters(e.key_as_string||e.key)&&((c=r.subFilterParentKeys)!=null&&c.length)?(a(),n("div",ce,[r.hasSubFilters(e.key_as_string||e.key)?(a(),n("div",de,[b(o.$slots,`slot_${r.getSubFilterParentKey(e.key_as_string||e.key)}`)])):y("",!0)])):y("",!0)]}),_:2},1032,["init-open"])):(a(),n(p,{key:1},[!s.truncateFilters||m<=l.checkbox.checkboxLimit-1?(a(),n("div",{key:0,class:F(["flex",{"pt-2 mt-2 mb-3":s.styleAsAccordion,"my-2":!s.styleAsAccordion}])},[_(i("input",{id:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),"onUpdate:modelValue":t[1]||(t[1]=c=>r.filterByHandler=c),type:"checkbox",value:e.key_as_string?e.key_as_string:e.key,class:"text-primary focus:ring-2 focus:ring-primary flex-shrink-0 w-5 h-5 mt-px mr-1 align-middle border rounded-none"},null,8,ue),[[K,r.filterByHandler]]),i("label",{for:e.key_as_string?r.generateId(e.key_as_string,s.groupKey):r.generateId(e.key,s.groupKey),class:F(["form-check-label pl-2 tracking-normal align-middle",{"font-extrabold":s.styleAsAccordion}])},[D(u(r.prettyFilterNames(e.key_as_string?e.key_as_string:e.key))+" ",1),i("span",_e," ("+u(e.doc_count.toLocaleString())+") ",1)],10,ye)],2)):y("",!0)],64))]))),128))])):(a(),n("div",ge,t[3]||(t[3]=[i("span",{class:"text-sm text-gray-mid-dark"},"No matching filters",-1)]))),_(i("div",null,[i("button",{class:"can-hover:hover:underline text-action mt-2","aria-expanded":l.checkbox.showMore?"false":"true","aria-haspopup":"true","aria-controls":`filterGroup_${s.groupKey}`,onClick:t[2]||(t[2]=e=>r.toggleShowMoreFilters())},u(l.checkbox.showMore==!1?"Less":"More"),9,he)],512),[[A,s.truncateFilters&&r.bucketsLength>l.checkbox.initialLimit]])],8,te)):y("",!0)}const ke=q(ee,[["render",me]]),Ae={title:"Components/Search/SearchFilterGroup",component:ke,tags:["search"],excludeStories:/.*Data$/},we={name:"Topic Filter",args:{filterBy:[],buckets:[{key:"Solar System",doc_count:3308},{key:"Earth",doc_count:1179},{key:"Stars and Galaxies",doc_count:979},{key:"Technology",doc_count:480}],groupKey:"topics",groupTitle:"Topic",truncateFilters:!1}},Be={args:{filterBy:[],buckets:[{key_as_string:"2021",key:16094592e5,doc_count:5},{key_as_string:"2020",key:15778368e5,doc_count:231},{key_as_string:"2019",key:15463008e5,doc_count:245},{key_as_string:"2018",key:15147648e5,doc_count:276},{key_as_string:"2017",key:14832288e5,doc_count:314},{key_as_string:"2016",key:14516064e5,doc_count:311},{key_as_string:"2015",key:14200704e5,doc_count:377},{key_as_string:"2014",key:13885344e5,doc_count:418},{key_as_string:"2013",key:13569984e5,doc_count:358},{key_as_string:"2012",key:1325376e6,doc_count:389},{key_as_string:"2011",key:129384e7,doc_count:367},{key_as_string:"2010",key:1262304e6,doc_count:389},{key_as_string:"2009",key:1230768e6,doc_count:172},{key_as_string:"2008",key:11991456e5,doc_count:227}],groupKey:"results_by_year",groupTitle:"Date",truncateFilters:!0}},Le={decorators:[()=>({template:'<div id="storyRoot" class="md:w-1/2 lg:w-1/3"><story /></div>'})],args:{filterBy:[],buckets:[{key:"Solar System",doc_count:3308},{key:"Earth",doc_count:1179},{key:"Stars and Galaxies",doc_count:979},{key:"Technology",doc_count:480}],groupKey:"topics",groupTitle:"Topic",truncateFilters:!1,subFilters:{solar_system:[{key:"Sun",agg:"solar_system_area",doc_count:20},{key:"Mercury",agg:"solar_system_area",doc_count:21},{key:"Venus",agg:"solar_system_area",doc_count:22}],earth:[{key:"Sea Level",agg:"solar_system_area",doc_count:20},{key:"Pollution",agg:"solar_system_area",doc_count:21},{key:"Climate Change",agg:"solar_system_area",doc_count:22}],stars_and_galaxies:[{key:"Sea Level",agg:"solar_system_area",doc_count:20},{key:"Pollution",agg:"solar_system_area",doc_count:21},{key:"Climate Change",agg:"solar_system_area",doc_count:22}],technology:[{key:"Sea Level",agg:"solar_system_area",doc_count:20},{key:"Pollution",agg:"solar_system_area",doc_count:21},{key:"Climate Change",agg:"solar_system_area",doc_count:22}]}}},Ce=["BaseStory","DateFilter","SubFilters"];export{we as BaseStory,Be as DateFilter,Le as SubFilters,Ce as __namedExportsOrder,Ae as default};
